<!DOCTYPE html>
<html>

<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
    <p>This add-in will insert the text 'Hello world!' 79 in a new message.</p>
</body>

<script>
    Office.onReady((info) => {
        if (info.host === Office.HostType.Outlook) {
            // Rufen Sie die Funktion direkt auf, um sie automatisch auszuführen
            //const Recipient = Office.context.mailbox.item.organizer.emailAddress;
            //var Recipient = Office.context.mailbox.item.organizer.displayName;
            //insertRecipientInfo();
            sayHello();
        }
    });

    function insertRecipientInfo() {
    // Zugriff auf die aktuelle E-Mail
    /*
    var item = Office.context.mailbox.item;

    // Empfängerinformationen abrufen
    var recipients = item.to; // Hier können Sie auch "cc" oder "bcc" verwenden

    // E-Mail-Adresse und Name des ersten Empfängers
    var firstRecipient = recipients[0];
    var emailAddress = firstRecipient.emailAddress;
    var displayName = firstRecipient.displayName;
    */

    var displayName = "Hi";
    // Text für den E-Mail-Body erstellen
    var bodyText = "Hallo " + displayName + ",\n\n";
    //bodyText += "Ihre E-Mail-Adresse lautet: " + emailAddress + "\n\n";
    bodyText += "Ihre E-Mail-Adresse lautet: " + "\n\n";
    bodyText += "Vielen Dank und beste Grüße!";

    Office.context.mailbox.item.body.setAsync(
            "Hello Recipient,<br><br><br><br> Best,<br>Sender" + "HALLO",
            {
                coercionType: "html", // Write text as HTML
            },

            // Callback method to check that setAsync succeeded
            function (asyncResult) {
                if (asyncResult.status ==
                    Office.AsyncResultStatus.Failed) {
                    write(asyncResult.error.message);
                }
            }

/*
    // E-Mail-Body aktualisieren
    item.body.setAsync(bodyText, { coercionType: Office.CoercionType.Text }, function (result) {
        if (result.status === Office.AsyncResultStatus.Succeeded) {
            console.log("Empfängerinformationen erfolgreich eingefügt.");
        } else {
            console.error("Fehler beim Einfügen der Empfängerinformationen: " + result.error.message);
        }
    });
*/
    }

    /**
     * Writes 'Hello world!' to a new message body.
     */
    function sayHello() {
        //NEW
        //var item = Office.context.mailbox.item;
        //var recipients = item.to; // Hier können Sie auch "cc" oder "bcc" verwenden
        var recipients = Office.context.mailbox.item.to;
        var firstRecipient = recipients[0];
        var emailAddress = firstRecipient.emailAddress;
        var displayName = firstRecipient.displayName;
        //NEW
        //var Recipient = Office.context.mailbox.item.organizer.emailAddress;
        //var Recipient = Office.context.mailbox.item.organizer.displayName;
        //var recipients = Office.context.mailbox.item.to;
        Office.context.mailbox.item.body.setAsync(
            "Hello Recipient,<br><br><br><br> Best,<br>Sender" + recipients + emailAddress,
            {
                coercionType: "html", // Write text as HTML
            },

            // Callback method to check that setAsync succeeded
            function (asyncResult) {
                if (asyncResult.status ==
                    Office.AsyncResultStatus.Failed) {
                    write(asyncResult.error.message);
                }
            }
        );
    }

</script>
</html>

<!DOCTYPE html>
<html>
<head>
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <button id="insertRecipientButton">Empfänger einfügen 1</button>

    <script>
        // Event-Handler für den Klick auf die Schaltfläche
        document.getElementById("insertRecipientButton").addEventListener("click", insertRecipientIntoBody);

        // Funktion zum Einfügen des Empfängers in den Body der Nachricht
        function insertRecipientIntoBody() {
            Office.context.mailbox.item.to.getAsync(function(result) {
                if (result.status === Office.AsyncResultStatus.Succeeded) {
                    var recipients = result.value;
                    var recipientEmails = recipients.map(function(recipient) {
                        return recipient.emailAddress;
                    });

                    var body = Office.context.mailbox.item.body;
                    body.prependText("Empfänger: " + recipientEmails.join(", "));
                } else {
                    console.error("Fehler beim Abrufen der Empfänger: " + result.error.message);
                }
            });
        }
    </script>
</body>
</html>
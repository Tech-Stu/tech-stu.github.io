<!DOCTYPE html>
<html>

<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
    <p>Dieses Add-In fügt automatisch den Text 'Hallo Welt!' 83 in eine neue Nachricht ein.</p>
</body>

<script>
    Office.onReady((info) => {
        if (info.host === Office.HostType.Outlook) {
            // Rufen Sie die Funktion direkt auf, um sie automatisch auszuführen
            insertRecipientInfo();
        }
    });

    function insertRecipientInfo() {
        // Zugriff auf die aktuelle E-Mail
        var item = Office.context.mailbox.item;

        // Empfängerinformationen abrufen
        var recipients = item.to; // Hier können Sie auch "cc" oder "bcc" verwenden

        // E-Mail-Adresse und Name des ersten Empfängers
        var firstRecipient = recipients[0];
        var emailAddress = firstRecipient.emailAddress;
        var displayName = firstRecipient.displayName;

        // Text für den E-Mail-Body erstellen
        var MeinText = "HALLO!"
        var bodyText = "Hallo " + displayName + ",\n\n";
        bodyText += "Ihre E-Mail-Adresse lautet: " + emailAddress + "\n\n";
        bodyText += "Vielen Dank und beste Grüße!";

        Office.context.mailbox.item.body.setAsync(
            "HALLO",
            {
                coercionType: "text", // Write text as plain text
            },

            // Callback-Methode zum Überprüfen, ob setAsync erfolgreich war
            function (asyncResult) {
                if (asyncResult.status == Office.AsyncResultStatus.Failed) {
                    console.error(asyncResult.error.message);
                }
            }
        );
    }
</script>

</html>

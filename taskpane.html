<!DOCTYPE html>
<html>

<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>

<body>
    <p>This add-in will insert the text 'Hello world!' 48 in a new message.</p>

    <script>
        Office.onReady((info) => {
            if (info.host === Office.HostType.Outlook) {
                // Stelle sicher, dass die Funktion direkt aufgerufen wird, nachdem Office.onReady ausgelöst wurde
                sayHello();
            }
        });

        /**
         * Writes 'Hello world!' to a new message body.
         */
        function sayHello() {
            // Überprüfe die Organisator-Eigenschaften, indem du sie in die Konsole schreibst
            console.log("Organizer:", Office.context.mailbox.item.organizer);

            // Verwende entweder die E-Mail-Adresse oder den Anzeigenamen des Organisators
            var Recipient = Office.context.mailbox.item.organizer.emailAddress;
            // var Recipient = Office.context.mailbox.item.organizer.displayName;

            // Setze den Text in den E-Mail-Body
            Office.context.mailbox.item.body.setAsync(
                `Hello ${Recipient},<br><br><br><br> Best,<br>Sender`,
                {
                    coercionType: "html", // Schreibe den Text als HTML
                },
                // Rückrufmethode, um zu überprüfen, dass setAsync erfolgreich war
                function (asyncResult) {
                    if (asyncResult.status == Office.AsyncResultStatus.Failed) {
                        console.error(asyncResult.error.message);
                    }
                }
            );
        }
    </script>
</body>

</html>
